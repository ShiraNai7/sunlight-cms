"use_strict";var Shira;!function(t,i){!function(t){t.Watcher=function(s,o){this.element=s,this.options=i.extend({},t.Watcher.defaults,o),null===this.options.topFixOffset&&(this.options.topFixOffset=-this.options.topPosition),null===this.options.topUnfixOffset&&(this.options.topUnfixOffset=this.options.topPosition),null===this.options.bottomFixOffset&&(this.options.bottomFixOffset=-this.options.bottomPosition),null===this.options.bottomUnfixOffset&&(this.options.bottomUnfixOffset=this.options.bottomPosition),i(s).data("shira.scrollfix",this)},t.Watcher.defaults={topFixClass:"scrollfix-top",bottomFixClass:"scrollfix-bottom",substituteClass:"scrollfix-subtitute",topPosition:0,bottomPosition:0,topFixOffset:null,topUnfixOffset:null,bottomFixOffset:null,bottomUnfixOffset:null,syncSize:!0,syncPosition:!0,style:!0,styleSubstitute:!0,side:"top"},t.Watcher.prototype={element:null,substitute:null,options:null,fixed:!1,fixedAt:null,attached:!1,checkTop:!1,checkBottom:!1,getElementX:function(t){var i=0;do i+=t.offsetLeft;while(t=t.offsetParent);return i},getElementY:function(t){var i=0;do i+=t.offsetTop;while(t=t.offsetParent);return i},fix:function(t){if(!this.fixed){if(this.dispatchEvent("fix").isDefaultPrevented())return;var s=i(this.element),o=i(this.element.cloneNode(!1)).addClass(this.options.substituteClass);if(this.options.styleSubstitute&&o.css("visibility","hidden").height(i(this.element).height()),this.substitute=o.insertAfter(this.element)[0],this.options.style){var e={position:"fixed"};"top"===t?e.top=this.options.topPosition+"px":e.bottom=this.options.bottomPosition+"px",s.css(e)}s.addClass("top"===t?this.options.topFixClass:this.options.bottomFixClass),this.fixed=!0,this.fixedAt=t,this.dispatchEvent("fixed")}},updateFixed:function(){if(this.options.syncSize&&i(this.element).width(i(this.substitute).width()),this.options.syncPosition){var t=i(window).scrollLeft(),s=this.getElementX(this.substitute);i(this.element).css("left",s-t+"px")}this.dispatchEvent("update")},unfix:function(){if(this.fixed){if(this.dispatchEvent("unfix").isDefaultPrevented())return;i(this.substitute).remove(),this.substitute=null;var t={};this.options.syncPosition&&(t.left=""),this.options.syncSize&&(t.width=""),this.options.style&&(t.position="",t[this.fixedAt]=""),i(this.element).css(t).removeClass("top"===this.fixedAt?this.options.topFixClass:this.options.bottomFixClass),this.fixed=!1,this.fixedAt=null,this.dispatchEvent("unfixed")}},attach:function(){if(!this.attached){var t=this;this.updateEventHandler=function(){t.pulse()},i(window).scroll(this.updateEventHandler).resize(this.updateEventHandler),this.attached=!0,this.pulse()}},detach:function(){this.attached&&(this.unfix(),i(window).unbind("scroll",this.updateEventHandler).unbind("resize",this.updateEventHandler),this.attached=!1)},pulse:function(){var t=i(window),s=t.scrollTop(),o=s+t.height(),e=this.fixed?this.substitute:this.element,n=this.getElementY(e),h=n+i(e).outerHeight();this.fixed?"top"===this.fixedAt?s<=n-this.options.topUnfixOffset&&this.unfix():o>=h+this.options.bottomUnfixOffset&&this.unfix():("top"===this.options.side||"both"===this.options.side)&&s>n+this.options.topFixOffset?this.fix("top"):("bottom"===this.options.side||"both"===this.options.side)&&o<h-this.options.bottomFixOffset&&this.fix("bottom"),this.fixed&&this.updateFixed()},dispatchEvent:function(t){var s=new i.Event(t+".shira.scrollfix",{watcher:this});return i(this.element).trigger(s),s}},i.fn.scrollFix=function(i){for(var s=0;s<this.length;++s)new t.Watcher(this[s],i).attach();return this}}(t.ScrollFix||(t.ScrollFix={}))}(Shira||(Shira={}),jQuery);